**Subdomain Takeover Vulnerability**

**Overview**:
A subdomain takeover vulnerability can enable an attacker to claim and control a victim's subdomain. Exploitation hinges on two primary conditions:
1. The victim's DNS server subdomain record pointing to a non-active or non-existent external service/resource.
2. The service provider not properly verifying subdomain ownership.

Successful exploitation can lead to attacks like serving malicious content, phishing, stealing user session cookies, and credentials. Various DNS resource records are susceptible, but the NS record takeover has the highest impact as it allows total control over the entire DNS zone and domain.

**Scenarios**:
1. **GitHub**:
   - The victim (victim.com) uses GitHub and has set up coderepo.victim.com to access it.
   - Upon migrating from GitHub without deleting the DNS record, an adversary can claim this subdomain through GitHub Pages.
  
2. **Expired Domain**:
   - The victim links www.victim.com to another domain (victimotherdomain.com) using a CNAME record.
   - If the secondary domain expires, anyone can register it and gain control over www.victim.com as long as the DNS record persists.

**Test Objectives**:
- Enumerate all domains, past and present.
- Spot forgotten or misconfigured domains.

**How to Test**:
1. **Black-Box Testing**:
   - Enumerate DNS servers and records using tools or OSINT sources.
   - Investigate DNS responses like NXDOMAIN, SERVFAIL, REFUSED, and unreachable servers.
   - Use tools like dnsrecon for enumeration.
   - Identify dead DNS records and verify them with commands like 'dig'.
   - For A records, use 'whois' to ascertain the service provider.
   - Verify vulnerabilities through HTTP requests and web browser visits.
  
2. **Gray-Box Testing**:
   - With the DNS zone file on hand, enumeration is unnecessary.
   - The testing process remains similar to black-box testing.

**Remediation**:
- Delete vulnerable DNS resource records from the DNS zone.
- Regular monitoring and checks are advisable to prevent potential subdomain takeovers.

**Figures**:
1. Figure 4.2.10-1 showcases a GitHub "404 File Not Found" response.
2. Figure 4.2.10-2 illustrates how one can claim a domain using GitHub Pages.